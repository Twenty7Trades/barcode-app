<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Round21 Barcode Generator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        .format-details {
            margin-top: 20px;
            padding: 20px;
            background-color: #0f0f0f;
            border: 1px solid #333;
            border-radius: 8px;
        }
        .format-details h3 {
            margin: 0 0 12px;
            color: #4b8bff;
        }
        .format-details h4 {
            margin: 16px 0 8px;
            color: #4b8bff;
        }
        .format-details .row-info {
            margin: 10px 0;
            padding: 8px;
            background-color: #1a1a1a;
            border: 1px solid #2a2a2a;
            border-radius: 4px;
        }
        .format-details .row-info strong {
            color: #eee;
        }
        .format-details ul {
            margin: 0;
            padding-left: 20px;
        }
        .format-details li {
            margin: 8px 0;
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Round21 Barcode Generator</h1>
        
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <div class="flash-messages">
                    {% for message in messages %}
                        <div class="flash-message">{{ message }}</div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        <form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data">
            <label class="block">Upload Spreadsheet (XLSX or CSV):</label>
            <input type="file" name="file" required>

            <div class="section">
                <label class="block">
                    <input type="checkbox" name="include_price" value="1" id="include_price">
                    Include Price
                </label>
                <div class="hint">If checked, prices from Column K of the spreadsheet will be displayed on each label.</div>
            </div>

            <div class="section">
                <label class="block">
                    <input type="checkbox" name="hot_market" value="1" id="hot_market">
                    Hot Market
                </label>
                <div class="hint">If checked, uses Hot Market format with 3 text rows and no price display.</div>
            </div>

            <div class="section">
                <label class="block">
                    <input type="checkbox" name="bda_format" value="1" id="bda_format">
                    BDA Format
                </label>
                <div class="hint">If checked, uses BDA format: Row 1 (Column K + Column C), Row 2 (Column L - Column E), Row 3 (Column B), UPC barcode, and Column J below barcode.</div>
            </div>

            <div class="section">
                <label class="block">
                    <input type="checkbox" name="round21_brand" value="1" id="round21_brand">
                    Round 21 Brand
                </label>
                <div class="hint">If checked, uses Round 21 Brand format: Row 1 (blank left, Column B right), Row 2 (Column D centered), Row 3 (Column A - Column G centered), and UPC barcode.</div>
            </div>

            <button type="submit">Generate Labels</button>
        </form>

        <div class="format-details" id="formatDetails">
            <h3>Standard Round21 Format Requirements:</h3>
            <ul>
                <li><strong>File Format:</strong> XLSX or CSV spreadsheet</li>
                <li><strong>Data starts at Row 12</strong> (stops at "Customer PO" in Column A)</li>
            </ul>
            <h4>Label Layout:</h4>
            <div class="row-info"><strong>Row 1:</strong> Title (Column C, or Column B if C is blank)</div>
            <div class="row-info"><strong>Row 2:</strong> SKU (Column A)</div>
            <div class="row-info"><strong>Row 3:</strong> Color (Column I)</div>
            <div class="row-info"><strong>Bottom:</strong> UPC-A barcode (Column H)</div>
            <div class="row-info"><strong>Optional:</strong> Price below barcode (Column K) if "Include Price" is checked</div>
            <h4>Required Columns:</h4>
            <ul>
                <li><strong>Column A:</strong> SKU</li>
                <li><strong>Column C:</strong> Title (or Column B as fallback)</li>
                <li><strong>Column H:</strong> UPC</li>
                <li><strong>Column I:</strong> Color</li>
                <li><strong>Column K:</strong> Price (optional)</li>
            </ul>
        </div>
    </div>

    <script>
        function updateFormatDetails() {
            const formatDetails = document.getElementById('formatDetails');
            const hotMarket = document.getElementById('hot_market').checked;
            const bdaFormat = document.getElementById('bda_format').checked;
            const round21Brand = document.getElementById('round21_brand').checked;
            const includePrice = document.getElementById('include_price').checked;

            if (round21Brand) {
                formatDetails.innerHTML = `
                    <h3>Round 21 Brand Format Requirements:</h3>
                    <ul>
                        <li><strong>File Format:</strong> XLSX or CSV spreadsheet</li>
                        <li><strong>Data starts at Row 12</strong> (stops at "Customer PO" in Column A)</li>
                    </ul>
                    <h4>Label Layout:</h4>
                    <div class="row-info"><strong>Row 1:</strong> Blank left, Column B right</div>
                    <div class="row-info"><strong>Row 2:</strong> Column D (centered, smaller font if > 26 characters)</div>
                    <div class="row-info"><strong>Row 3:</strong> Column A - Column G (centered, hyphenated)</div>
                    <div class="row-info"><strong>Bottom:</strong> UPC-A barcode (Column H)</div>
                    <h4>Required Columns:</h4>
                    <ul>
                        <li><strong>Column A:</strong> Row 3 left part (before hyphen)</li>
                        <li><strong>Column B:</strong> Row 1 right side</li>
                        <li><strong>Column D:</strong> Row 2 centered text</li>
                        <li><strong>Column G:</strong> Row 3 right part (after hyphen)</li>
                        <li><strong>Column H:</strong> UPC</li>
                    </ul>
                `;
            } else if (bdaFormat) {
                formatDetails.innerHTML = `
                    <h3>BDA Format Requirements:</h3>
                    <ul>
                        <li><strong>File Format:</strong> XLSX or CSV spreadsheet</li>
                        <li><strong>Data starts at Row 12</strong> (stops at "Customer PO" in Column A)</li>
                    </ul>
                    <h4>Label Layout:</h4>
                    <div class="row-info"><strong>Row 1:</strong> Column K (left) + Column C (right)</div>
                    <div class="row-info"><strong>Row 2:</strong> Column L - Column E (centered, hyphenated)</div>
                    <div class="row-info"><strong>Row 3:</strong> Column B (centered, wraps up to 3 lines if needed)</div>
                    <div class="row-info"><strong>Bottom:</strong> UPC-A barcode (Column H)</div>
                    <div class="row-info"><strong>Below Barcode:</strong> Column J (centered, formatted as currency)</div>
                    <h4>Required Columns:</h4>
                    <ul>
                        <li><strong>Column B:</strong> Row 3 text</li>
                        <li><strong>Column C:</strong> Row 1 right side</li>
                        <li><strong>Column E:</strong> Row 2 right part (after hyphen)</li>
                        <li><strong>Column H:</strong> UPC</li>
                        <li><strong>Column J:</strong> Price below barcode (currency formatted)</li>
                        <li><strong>Column K:</strong> Row 1 left side</li>
                        <li><strong>Column L:</strong> Row 2 left part (before hyphen)</li>
                    </ul>
                `;
            } else if (hotMarket) {
                formatDetails.innerHTML = `
                    <h3>Hot Market Format Requirements:</h3>
                    <ul>
                        <li><strong>File Format:</strong> XLSX or CSV spreadsheet</li>
                        <li><strong>Data starts at Row 12</strong> (stops at "Customer PO" in Column A)</li>
                    </ul>
                    <h4>Label Layout:</h4>
                    <div class="row-info"><strong>Row 1:</strong> Column J (left) + Column C (right)</div>
                    <div class="row-info"><strong>Row 2:</strong> Column B (centered, wraps up to 3 lines if needed)</div>
                    <div class="row-info"><strong>Row 3:</strong> Column A - Column E (centered, hyphenated)</div>
                    <div class="row-info"><strong>Bottom:</strong> UPC-A barcode (Column H)</div>
                    <h4>Required Columns:</h4>
                    <ul>
                        <li><strong>Column A:</strong> Row 3 left part (before hyphen)</li>
                        <li><strong>Column B:</strong> Row 2 text (wraps if long)</li>
                        <li><strong>Column C:</strong> Row 1 right side</li>
                        <li><strong>Column E:</strong> Row 3 right part (after hyphen)</li>
                        <li><strong>Column H:</strong> UPC</li>
                        <li><strong>Column J:</strong> Row 1 left side</li>
                    </ul>
                `;
            } else {
                formatDetails.innerHTML = `
                    <h3>Standard Round21 Format Requirements:</h3>
                    <ul>
                        <li><strong>File Format:</strong> XLSX or CSV spreadsheet</li>
                        <li><strong>Data starts at Row 12</strong> (stops at "Customer PO" in Column A)</li>
                    </ul>
                    <h4>Label Layout:</h4>
                    <div class="row-info"><strong>Row 1:</strong> Title (Column C, or Column B if C is blank)</div>
                    <div class="row-info"><strong>Row 2:</strong> SKU (Column A)</div>
                    <div class="row-info"><strong>Row 3:</strong> Color (Column I)</div>
                    <div class="row-info"><strong>Bottom:</strong> UPC-A barcode (Column H)</div>
                    <div class="row-info"><strong>Optional:</strong> Price below barcode (Column K) if "Include Price" is checked</div>
                    <h4>Required Columns:</h4>
                    <ul>
                        <li><strong>Column A:</strong> SKU</li>
                        <li><strong>Column C:</strong> Title (or Column B as fallback)</li>
                        <li><strong>Column H:</strong> UPC</li>
                        <li><strong>Column I:</strong> Color</li>
                        <li><strong>Column K:</strong> Price (optional)</li>
                    </ul>
                `;
            }
        }

        // Add event listeners to all checkboxes
        document.getElementById('hot_market').addEventListener('change', updateFormatDetails);
        document.getElementById('bda_format').addEventListener('change', updateFormatDetails);
        document.getElementById('round21_brand').addEventListener('change', updateFormatDetails);
        document.getElementById('include_price').addEventListener('change', updateFormatDetails);

        // Ensure only one format checkbox can be selected at a time
        document.getElementById('hot_market').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('bda_format').checked = false;
                document.getElementById('round21_brand').checked = false;
                updateFormatDetails();
            }
        });
        document.getElementById('bda_format').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('hot_market').checked = false;
                document.getElementById('round21_brand').checked = false;
                updateFormatDetails();
            }
        });
        document.getElementById('round21_brand').addEventListener('change', function() {
            if (this.checked) {
                document.getElementById('hot_market').checked = false;
                document.getElementById('bda_format').checked = false;
                updateFormatDetails();
            }
        });
    </script>
</body>
</html>
